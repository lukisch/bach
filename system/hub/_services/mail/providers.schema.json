{
  "$schema": "http:/json-schema.org/draft-07/schema#",
  "$id": "providers.schema.json",
  "title": "BACH Mail Provider Registry",
  "description": "Schema f체r Provider-Profile zur automatischen E-Mail-Erkennung (Task 272)",
  "type": "object",
  "required": ["providers", "categories"],
  "properties": {
    "providers": {
      "type": "array",
      "description": "Liste aller Provider-Profile",
      "items": {
        "$ref": "#/definitions/provider"
      }
    },
    "categories": {
      "type": "object",
      "description": "Kategorie-Definitionen mit Icon und Farbe",
      "additionalProperties": {
        "$ref": "#/definitions/category"
      }
    },
    "steuer_typen": {
      "type": "object",
      "description": "Verf체gbare Steuer-Typen mit Erkl채rungen",
      "additionalProperties": {
        "type": "string"
      }
    }
  },
  "definitions": {
    "provider": {
      "type": "object",
      "required": ["id", "name", "category", "type", "sender_patterns", "subject_patterns"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Eindeutige Provider-ID (snake_case)",
          "pattern": "^[a-z][a-z0-9_]*$"
        },
        "name": {
          "type": "string",
          "description": "Anzeigename des Providers"
        },
        "category": {
          "type": "string",
          "description": "Kategorie (muss in categories definiert sein)"
        },
        "type": {
          "type": "string",
          "description": "Dokumenttyp",
          "enum": ["rechnung", "police", "kontoauszug", "transaktion", "bescheid", "quittung", "nachweis", "abo"]
        },
        "steuer_relevant": {
          "type": "boolean",
          "description": "Steuerlich relevant?",
          "default": false
        },
        "steuer_typ": {
          "type": "string",
          "description": "Art der steuerlichen Absetzbarkeit",
          "enum": ["Werbungskosten", "Versicherung", "Sonderausgaben", "Nachweis"]
        },
        "hinweis": {
          "type": "string",
          "description": "Zus채tzlicher Hinweis (z.B. Absetzbarkeit)"
        },
        "sender_patterns": {
          "type": "array",
          "description": "SELECTORS: Absender-Muster (Domain/Name)",
          "items": { "type": "string" },
          "minItems": 1
        },
        "subject_patterns": {
          "type": "array",
          "description": "SELECTORS: Betreff-Muster (Keywords)",
          "items": { "type": "string" },
          "minItems": 1
        },
        "blacklist": {
          "type": "array",
          "description": "ANTI_SELECTORS: Ausschluss-Keywords im Betreff",
          "items": { "type": "string" }
        },
        "body_must_contain": {
          "type": "array",
          "description": "SELECTORS: Pflicht-Keywords im Body",
          "items": { "type": "string" }
        },
        "extract_fields": {
          "type": "array",
          "description": "EXTRACTION: Zu extrahierende Felder",
          "items": { "type": "string" }
        },
        "recurring": {
          "type": "boolean",
          "description": "Wiederkehrende Zahlung?",
          "default": false
        },
        "interval": {
          "type": "string",
          "description": "Zahlungsintervall bei recurring=true",
          "enum": ["monatlich", "quartalsweise", "jaehrlich"]
        }
      }
    },
    "category": {
      "type": "object",
      "required": ["icon", "color"],
      "properties": {
        "icon": {
          "type": "string",
          "description": "Lucide Icon-Name"
        },
        "color": {
          "type": "string",
          "description": "Hex-Farbcode",
          "pattern": "^#[0-9a-fA-F]{6}$"
        },
        "steuer": {
          "type": "boolean",
          "description": "Kategorie generell steuer-relevant?"
        }
      }
    }
  }
}
