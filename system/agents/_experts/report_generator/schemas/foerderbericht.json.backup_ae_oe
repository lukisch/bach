{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Foerderbericht ICF-basiert",
  "description": "JSON-Schema fuer die LLM-generierte Berichtsstruktur eines ICF-basierten Foerderberichts (Autismus-Foerderung)",
  "version": "1.0.0",
  "type": "object",
  "required": ["stammdaten", "foerderziele", "bereiche", "empfehlung", "abschluss"],
  "properties": {
    "stammdaten": {
      "type": "object",
      "description": "Allgemeine Informationen zum Klienten und zur Foerderung",
      "properties": {
        "name": { "type": "string", "description": "Name des Klienten (Tarnname)" },
        "geburtsdatum": { "type": "string", "description": "Geburtsdatum (dd.mm.yyyy, Fake)" },
        "sachbearbeiter": { "type": "string", "description": "Name der zustaendigen Sachbearbeiter*in" },
        "kostenzusage_ende": { "type": "string", "description": "Datum Ende der Kostenzusage (dd.mm.yyyy)" },
        "weiterbewilligung_ab": { "type": "string", "description": "Datum Weiterbewilligung ab (dd.mm.yyyy)" },
        "foerderungsbeginn": { "type": "string", "description": "Datum Foerderungsbeginn (dd.mm.yyyy)" },
        "diagnosen": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Liste der Diagnosen mit Datum und Quelle"
        },
        "therapieangebot": {
          "type": "object",
          "properties": {
            "einzelfoerderung": { "type": "boolean" },
            "gruppenfoerderung": { "type": "boolean" },
            "co_foerderung": { "type": "boolean" },
            "foerderdiagnostik": { "type": "boolean" }
          }
        },
        "netzwerkarbeit": {
          "type": "object",
          "properties": {
            "elternarbeit": { "type": "boolean" },
            "kindergarten": { "type": "boolean" },
            "schule": { "type": "boolean" },
            "sonstige": { "type": "boolean" }
          }
        }
      }
    },

    "foerderziele": {
      "type": "array",
      "description": "Aktive Foerderziele mit ICF-Code, Ist-Stand und Bewertung",
      "items": {
        "type": "object",
        "required": ["icf_code", "zielformulierung", "ist_stand", "erreicht"],
        "properties": {
          "icf_code": {
            "type": "string",
            "description": "ICF-Code (z.B. D350, D710, D230)"
          },
          "zielformulierung": {
            "type": "string",
            "description": "Konkrete Zielformulierung fuer diesen Bereich"
          },
          "ist_stand": {
            "type": "string",
            "description": "Ausfuehrliche Beschreibung des aktuellen Entwicklungsstandes. Mindestens 2-3 Saetze basierend auf den Beobachtungen."
          },
          "erreicht": {
            "type": "integer",
            "enum": [1, 2, 3],
            "description": "1=nicht erreicht, 2=teilweise erreicht, 3=erreicht"
          },
          "grund_nichterreichung": {
            "type": ["integer", "null"],
            "enum": [1, 2, 3, 4, null],
            "description": "Nur bei erreicht=1 oder 2: 1=nicht mehr relevant, 2=Aenderung Bedarfslage, 3=Ziele unrealistisch, 4=sonstiges"
          }
        }
      }
    },

    "bereiche": {
      "type": "object",
      "description": "Weitere ICF-Bereiche als individualisierte Satzbausteine",
      "properties": {
        "mobilitaet": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Individualisierter Text fuer Mobilitaet (D47xx)" }
          }
        },
        "selbstversorgung": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Individualisierter Text fuer Selbstversorgung (D5xx)" }
          }
        },
        "haushalt": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Individualisierter Text fuer Haushalt (D6xx)" }
          }
        },
        "lebensbereiche": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Individualisierter Text fuer Lebensbereiche (D8xx): Schule, Beruf, Geld" }
          }
        },
        "gesellschaft_freizeit": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Individualisierter Text fuer Gesellschaft/Freizeit (D9xx)" }
          }
        }
      }
    },

    "umweltfaktoren": {
      "type": "object",
      "description": "Besonderheiten und Umweltfaktoren des Klienten",
      "properties": {
        "wahrnehmung": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Wahrnehmungsbesonderheiten (Licht, Geraeusche, Taktil, etc.)" }
          }
        },
        "kommunikation": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Kommunikationshilfen und -technologien" }
          }
        },
        "kognition_motorik": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Kognitive/motorische Besonderheiten" }
          }
        },
        "medizinisches": {
          "type": "object",
          "properties": {
            "aktiv": { "type": "boolean" },
            "text": { "type": "string", "description": "Medizinische Faktoren (Schlaf, Affekte, ADHS, etc.)" }
          }
        }
      }
    },

    "besondere_faehigkeiten": {
      "type": "string",
      "description": "Besondere Staerken und Faehigkeiten des Klienten (1-2 Saetze)"
    },

    "neue_ziele": {
      "type": "array",
      "description": "Neue Foerderziele fuer den naechsten Zeitraum",
      "items": {
        "type": "object",
        "required": ["icf_code", "zielformulierung", "ist_stand"],
        "properties": {
          "icf_code": { "type": "string" },
          "zielformulierung": { "type": "string" },
          "ist_stand": { "type": "string", "description": "Aktuelle Ausgangslage fuer das neue Ziel" }
        }
      }
    },

    "empfehlung": {
      "type": "object",
      "description": "Empfehlung fuer den weiteren Foerderverlauf",
      "required": ["verlaengerung", "begruendung"],
      "properties": {
        "verlaengerung": {
          "type": "boolean",
          "description": "true=Verlaengerung empfohlen, false=Beendigung"
        },
        "begruendung": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "therapieziele_nicht_erreicht",
              "uebergang_lebensbereich",
              "krise_erhoehter_bedarf",
              "sonstiges",
              "ziele_erreicht",
              "andere_therapie_vorrangig",
              "pausierung"
            ]
          }
        },
        "umfang": {
          "type": "string",
          "description": "Empfohlener Foerderumfang (z.B. '4 x 75 Minuten Einzelfoerderung pro Monat')"
        },
        "sonstige_empfehlung": {
          "type": ["string", "null"],
          "description": "Optionale sonstige Empfehlung"
        }
      }
    },

    "abschluss": {
      "type": "object",
      "description": "Abschliessende Bemerkungen",
      "required": ["aktuelle_entwicklungen", "bedingungsmodell"],
      "properties": {
        "aktuelle_entwicklungen": {
          "type": "string",
          "description": "2-4 Saetze zu aktuellen Fortschritten und wichtigen Entwicklungen"
        },
        "bedingungsmodell": {
          "type": "string",
          "description": "2-4 Saetze: Bedingungsmodell (Diagnose -> Einschraenkungen -> Teilhabeproblematik) und Empfehlung zur Fortfuehrung"
        }
      }
    }
  }
}
