# Portabilitaet: UNIVERSAL
# Version: 3.1.6
# Zuletzt validiert: 2026-02-23 (3D-Installer-Modell, BACHInstallerWizard)
# Naechste Pruefung: 2026-08-23

BACH v3 - FEATURES
====================

Uebersicht aller implementierten Features und deren Status.

ARCHITEKTUR v2.0 (NEU)
----------------------
Registry-Based Handler-System mit Auto-Discovery:
- 64+ Handler in hub/ automatisch erkannt
- Library-API (bach_api.py) fuer programmatischen Zugriff
- Dual-Init Handler (Path + App Support)
- Multi-Handler-Dateien (time.py, tuev.py)
- Kognitive Injektoren integriert

Zwei Zugriffswege:
1. CLI:         python bach.py task add "..." --priority P4
2. Library-API: from bach_api import task; task.add("...", "--priority", "P4")

CLI-BEFEHLE (Kern)
------------------
bach --startup              Session starten (mit DirScan, GUI)
bach --shutdown             Session beenden (Memory archivieren)
bach --status               System-Status anzeigen
bach --help [thema]         Hilfe (60+ Themen)

TASK-MANAGEMENT
---------------
bach task add "..."         Neue Aufgabe erstellen
bach task list              Aufgaben anzeigen
bach task done T001         Aufgabe abschliessen
bach task edit T001 "..."   Aufgabe bearbeiten

MEMORY-SYSTEM
-------------
bach mem write "..."        In Memory schreiben
bach mem read               Memory lesen
bach mem context            Kontext anzeigen
bach mem archive            Session archivieren

NACHRICHTEN
-----------
bach msg send "..."         Nachricht senden
bach msg list               Nachrichten anzeigen
bach msg read M001          Nachricht lesen
bach msg unread             Ungelesene anzeigen

SCANNER
-------
bach scan run               Tools scannen
bach scan status            Scan-Status
bach scan tasks             Gescannte Tasks anzeigen

WARTUNG (Daemon)
----------------
bach daemon jobs            Jobs anzeigen
bach daemon run J001        Job ausfuehren
bach daemon toggle J001     Job aktivieren/deaktivieren

GUI & REST-API
--------------
bach gui start              Web-Dashboard starten (Port 8000)
bach gui start-bg           Im Hintergrund starten
bach gui status             Server-Status

REST-API (Headless Server):
  python gui/api/headless.py --port 8001
  Endpoints:
    GET  /api/v1/tasks             Tasks auflisten
    POST /api/v1/tasks             Task erstellen
    GET  /api/v1/memory/facts      Fakten abrufen
    POST /api/v1/messages/send     Nachricht in Queue einreihen
    GET  /api/v1/messages/inbox    Inbox lesen
    GET  /api/v1/status            System-Status
  Swagger Docs: http://localhost:8001/api/docs

INJEKTOREN
----------
bach --inject status        Injektor-Status
bach --inject toggle X      Injektor an/aus
bach --inject task 5        Zeitbudget-Task

BACKUP
------
bach backup create          Backup erstellen
bach backup list            Backups anzeigen
bach backup restore X       Backup wiederherstellen

DATENBANK
---------
bach --db status            DB-Status
bach --db query "SQL"       SQL ausfuehren

CONNECTOR-SYSTEM v2.0 (NEU)
---------------------------
Zuverlaessige Nachrichtenzustellung mit Queue, Retry/Backoff, Circuit Breaker.
Runtime-Adapter: Telegram, Discord, HomeAssistant

bach connector list         Connectors anzeigen
bach connector status       Status aktiver Connectors
bach connector add <type>   Neuen Connector registrieren
bach connector messages     Nachrichten anzeigen
bach connector poll <name>  Einmal pollen (Nachrichten holen)
bach connector dispatch     Queue abarbeiten (Nachrichten versenden)
bach connector queue-status Queue-Statistiken (pending/failed/dead)
bach connector retry [id]   Dead-Letter zuruecksetzen

Daemon-Integration:
  poll_and_route (alle 2min) - Pollen + Routing
  dispatch (alle 1min)        - Queue abarbeiten

Features:
- Retry mit exponentiellen Backoff (30s bis 480s)
- Circuit Breaker (nach 5 Fehlern 5min Cooldown)
- Dead-Letter Queue fuer fehlgeschlagene Nachrichten
- Kontext-Trigger fuer Injektoren beim Routing

VOICE SERVICE (NEU)
-------------------
STT (Speech-to-Text): Whisper (online), Vosk (offline)
TTS (Text-to-Speech): pyttsx3 (Windows SAPI5 / espeak)
Wake-Word: openwakeword (optional), Keyboard-Fallback

Tool-Pfad: system/hub/_services/voice/voice_stt.py
Integration: Kann in Connector-System eingebunden werden

FEATURE-MATRIX
--------------

| Bereich           | Soll | Ist  | Status |
|-------------------|------|------|--------|
| CLI-Befehle       | 20   | 60+  | OK     |
| Help-Themen       | 21   | 60+  | OK     |
| Handler (Registry)| 12   | 64+  | OK     |
| Skills (Datei)    | 30   | 50+  | OK     |
| Skills (JSON)     | 50   | 0    | JSON*  |
| Tools (Datei)     | 30   | 90+  | OK     |
| Tools (Registry)  | 60   | 85   | OK     |
| GUI Endpunkte     | 30   | 80+  | OK     |
| REST-API Endpoints| 10   | 12   | OK     |
| DB Tabellen       | 25   | 114  | OK     |
| Connectors        | 3    | 3+   | OK     |

*) Skills & Experten werden primär über skills_hierarchy.json verwaltet.

Handler (Auto-Discovery in hub/):
  abo, agents, ati, backup, bericht, calendar, chain, connections,
  connector, consolidation, contact, context, cv, daemon, data_analysis,
  db, dist, doc, docs, extensions, fs, gesundheit, gui, haushalt, health,
  help, inbox, inject, lang, lesson, logs, maintain, memory, messages,
  mount, multi_llm_protocol, notify, obsidian, ollama, partner, path,
  profile, profiler, recurring, reflection, routine, scan, session,
  shutdown, skills, smarthome, snapshot, sources, startup, status,
  steuer, sync, task, test, time, tokens, tools, trash, tuev, update,
  versicherung, wiki

IMPLEMENTIERTE GUI DASHBOARDS
-----------------------------
- Startseite (Overview, Tokens, Inbox)
- Skills Board (Agents, Experts, Skills, Tools)
- Memory Board (Working, Facts, Lessons, Sessions)
- Financial (Finanzassistent / Insurance)
- Foerderplaner (Client Pipeline)
- Gesundheit (Gesundheitsassistent - Beta)
- ATI (Konzept-Entwicklung)

GEPLANTE FEATURES
-----------------
- Skill-Sync          Automatischer Abgleich Dateien <-> Hierarchy
- Multi-LLM Shared    Echter Shared Context über verschiedene Modelle
- Autonomous Mode     Agenten können selbstständig Tasks ausführen (Loop)
- Voice Full-Stack    Vollständige Voice-Interface-Integration (STT/TTS/Wake)
- Signal Connector    Erweiterung Connector-System um Signal-Messenger
- WhatsApp Connector  Erweiterung Connector-System um WhatsApp

CHANGELOG v2.0 (2026-02-06 bis 2026-02-08)
-------------------------------------------
[v2.0.0 - 2026-02-08] Registry-Based + Connector v2.0 + Voice
+ Registry-Based Handler-System (Auto-Discovery, 64+ Handler)
+ Library-API (bach_api.py) fuer programmatischen Zugriff
+ Connector-System v2.0: Queue, Retry/Backoff, Circuit Breaker
+ Runtime-Adapter: Telegram, Discord, HomeAssistant
+ Voice Service: STT (Whisper/Vosk), TTS (pyttsx3), Wake-Word
+ REST-API Headless Server (Port 8001, 12 Endpoints)
+ Daemon-Integration (poll_and_route + dispatch Jobs)
+ Schema-Migration mit Retry-Tracking und Circuit Breaker
+ DB-Schema: 114 Tabellen (Single Source of Truth)
+ 50 Tests (test_core + test_smoke) - alle gruen
+ Log-Pfade konsolidiert (nur noch system/data/logs/)
+ _partners Ordner konsolidiert (nur noch system/partners/)

SIEHE AUCH
----------
bach --help gui         Web-Dashboard Details
bach --help tasks       Task-Management
bach --help wartung     Wartung (Jobs/Daemon)
bach --help dirscan     Scanner-System
bach --help connector   Connector-System Details

WEITERE RESSOURCEN
------------------
- Architektur-Doku: docs/con3_ANFORDERUNGSANALYSE.md
- Changelog: memory/MEMORY.md (Abschnitt bach.py v2.0)
- Tests: system/tests/ (test_core.py, test_smoke.py)
- REST-API Swagger: http://localhost:8001/api/docs (wenn Server laeuft)
- Library-API Beispiele: system/bach_api.py (Docstring)
