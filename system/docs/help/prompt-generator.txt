# Portabilitaet: UNIVERSAL
# Version: 1.0.1
# Zuletzt validiert: 2026-02-08 (Help-Forensik)
# Naechste Pruefung: 2026-08-08

BACH PROMPT-GENERATOR
=====================

Der Prompt-Generator ist ein GUI-Board zum Erstellen, Verwalten und
Senden von Prompts an Claude-Sessions - manuell oder automatisiert.

STATUS:   FUNKTIONAL (Service implementiert, Handler fehlt)
HANDLER:  NICHT REGISTRIERT (kein bach.py Integration)
SERVICE:  hub/_services/prompt_generator/
GUI:      gui/prompt_manager.py (PyQt6, eigenstaendig)


KONZEPT
-------

Das Board bietet systemweites Prompt-Management mit folgenden Features:

  1. Texteditor fuer Startprompt (mit Reset-Funktion)
  2. Vorlagen-Auswahl (System/Agenten/Eigene)
  3. Vier Sendeoptionen
  4. Daemon-Steuerung (Zeitplanung)


SENDEOPTIONEN (4 Modi)
----------------------

  1. ALS TASK
     - Prompt wird als Task in die Warteschlange gestellt
     - Asynchrone Abarbeitung durch naechste Claude-Session
     - Keine sofortige Ausfuehrung

  2. DIREKT SESSION
     - Startet sofort eine neue Claude-Session
     - Prompt wird via Quick-Entry (Ctrl+Alt+Space) gesendet
     - Blockierend bis Session-Ende

  3. TEXT KOPIEREN
     - Kopiert den Prompt in die Zwischenablage
     - User fuegt manuell in Claude ein
     - Fuer Anpassungen vor dem Senden

  4. DAEMON-STEUERUNG
     - Automatisierte Prompt-Ausfuehrung
     - Konfigurierbar: Intervall, Sperrzeiten, Max-Sessions
     - Single-Prompt oder Multi-Prompt Rotation


VORLAGEN-SYSTEM
---------------

  System-Vorlagen (nicht editierbar, fuer Reset):
    - minimal.txt      Basis: Lies SKILL.md, fuehre bach.py aus
    - task.txt         Task-Ausfuehrung mit JSON-Output
    - review.txt       Code-Review mit Scoring

  Agenten-Vorlagen:
    - ati.txt          Software-Entwicklung (ATI Agent)
    - steuer.txt       Buchhaltung (Steuer Agent)
    - wartung.txt      BACH System-Wartung

  Eigene Vorlagen:
    - Vom User erstellte/angepasste Prompts
    - Gespeichert in DB (prompt_templates Tabelle)


DAEMON-STEUERUNG
----------------

Erweiterte Optionen fuer automatisierte Sessions:

  Intervall:        Minuten zwischen Sessions (default: 30)
  Max Sessions:     Limit pro Durchlauf (0 = unbegrenzt)
  Sperrzeiten:      Start/Ende der Ruhezeit (default: 22:00-08:00)
  Hoechstdauer:     Max. Minuten pro Session (default: 15)

  Modi:
    Single Prompt:  Immer derselbe Prompt
    Multi Prompt:   Rotation durch verschiedene Vorlagen

  One-Line:         Nur 1 Session gleichzeitig aktiv (Default)


GUI-LAYOUT (gui/prompt_manager.py - IMPLEMENTIERT)
---------------------------------------------------

  PyQt6-basierter Dark-Theme Manager mit:
  - Tab 1: Prompt Editor + Vorlagen (System/Agents/Custom)
  - Tab 2: Daemon-Steuerung (Intervalle, Ruhezeiten, Profilen)
  - Tab 3: Template-Verwaltung
  - Tab 4: Profil-Management
  - System Tray Icon
  - Single Instance Lock

  Aufruf: python system/gui/prompt_manager.py


CLI BEFEHLE (AKTUELL)
---------------------

DIREKTER AUFRUF (Service-Script):
  cd system/hub/_services/prompt_generator
  python prompt_generator.py list
  python prompt_generator.py get <path>
  python prompt_generator.py generate <path>
  python prompt_generator.py copy <path>
  python prompt_generator.py session [agent]
  python prompt_generator.py start [agent]
  python prompt_generator.py status

GUI STARTEN:
  python system/gui/prompt_manager.py

BACH.PY INTEGRATION:
  FEHLT - Kein Handler registriert!
  "python bach.py prompt list" funktioniert NICHT
  "python bach.py --prompt list" funktioniert NICHT


ABGRENZUNG: DREI HANDLER-SYSTEME
--------------------------------

  ┌─────────────────────────────────────────────────────────────────┐
  │  PROMPT-GENERATOR                                               │
  ├─────────────────────────────────────────────────────────────────┤
  │  Prompts erstellen, verwalten, senden                           │
  │  Manuell oder automatisiert                                     │
  │  Systemweit fuer alle Agenten                                   │
  │  Handler:  FEHLT (nicht in Registry)                            │
  │  Service:  hub/_services/prompt_generator/prompt_generator.py   │
  │  GUI:      gui/prompt_manager.py (PyQt6, eigenstaendig)         │
  │  Daemon:   JA (session_daemon.py)                               │
  │  API:      FEHLT (nicht in bach_api.py)                         │
  └─────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────┐
  │  WARTUNG (docs/docs/docs/help/wartung.txt)                                     │
  ├─────────────────────────────────────────────────────────────────┤
  │  Shell/Python-Befehle ausfuehren (Backup, Cleanup)              │
  │  Keine Prompts, nur Befehle                                     │
  │  Handler:  hub/daemon.py (registriert)                          │
  │  Service:  gui/api/daemon_api.py + DB                           │
  │  GUI:      /daemon (Web-Dashboard)                              │
  │  Daemon:   JA (eigener Prozess)                                 │
  └─────────────────────────────────────────────────────────────────┘

  ┌─────────────────────────────────────────────────────────────────┐
  │  RECURRING (docs/docs/docs/help/recurring.txt)                                 │
  ├─────────────────────────────────────────────────────────────────┤
  │  Erstellt Tasks als Erinnerungen                                │
  │  Kein Prompt-Sending                                            │
  │  Handler:  hub/recurring.py (registriert)                       │
  │  Service:  hub/_services/recurring/                             │
  │  GUI:      KEINE (nur CLI)                                      │
  │  Daemon:   NEIN (Check bei Aufruf)                              │
  └─────────────────────────────────────────────────────────────────┘


TECHNISCHE BASIS
----------------

  Service-Ordner: hub/_services/prompt_generator/
    ├── README.md              Dokumentation
    ├── config.json            Konfiguration (Daemon-Einstellungen)
    ├── prompt_generator.py    Hauptlogik (CLI + API)
    ├── templates/             Template-Ordner
    │   ├── system/            Read-only Vorlagen
    │   │   ├── minimal.txt
    │   │   ├── task.txt
    │   │   └── review.txt
    │   └── agents/            Editierbare Vorlagen
    │       ├── ati.txt
    │       ├── steuer.txt
    │       └── wartung.txt
    └── profiles/              Daemon-Profile
        ├── ati.json
        └── wartung.json

  GUI: gui/prompt_manager.py (PyQt6, eigenstaendig)

  FEHLENDE INTEGRATION:
    - Kein Handler in hub/ (nicht in Registry)
    - Kein bach_api Modul (fehlt in bach_api.py)
    - Aufruf via "bach.py prompt" NICHT moeglich


BEKANNTE PROBLEME
-----------------

1. KEINE BACH.PY INTEGRATION
   - Service ist funktional, aber nicht in bach.py Registry
   - "python bach.py prompt list" → Fehler
   - Workaround: Direkter Service-Aufruf (siehe CLI BEFEHLE)

2. KEINE BACH_API INTEGRATION
   - Kein "prompt" Modul in bach_api.py
   - Library-API nicht nutzbar
   - Workaround: Service direkt importieren

3. PFAD-INKONSISTENZEN
   - Help-Datei verwies auf skills/_services/ (alt)
   - Tatsaechlich in hub/_services/ (korrekt)

MIGRATION ERFORDERLICH:
  - Handler erstellen in hub/prompt.py
  - In Registry registrieren (BaseHandler-Klasse)
  - bach_api.py erweitern um prompt = _HandlerProxy("prompt")


SIEHE AUCH
----------

  help wartung      Wartungs-Jobs (Shell-Befehle)
  help recurring    Wiederkehrende Task-Erinnerungen (keine GUI)
  help ati          ATI Software-Entwickler Agent
  help daemon       Daemon-Verwaltung (Wartung vs. Session-Daemon)
