# Portabilitaet: SYSTEM
# Zuletzt validiert: 2026-02-08
# Naechste Pruefung: 2026-05-08
# Ressourcen: [hub/partner.py, tools/partner_communication/gemini_start.py, partners/gemini/start_gemini.bat]

BACH PARTNER-DELEGATION
=======================

STAND: 2026-02-08

Die Delegation ermöglicht die Verteilung von Aufgaben innerhalb
des Partner-Netzwerks basierend auf Expertise und Token-Ökonomie.

Handler: system/hub/partner.py (DB-basiert seit JSON_001 Migration)

KERNAUFGABEN
------------
- Task-Delegation via CLI oder MessageBox (data/messages/message_box.md)
- Monitoring des Fortschritts über `bach partner status`
- Token-bewusste Auswahl basierend auf Zonen (monitor_tokens DB-Tabelle)
- Offline-Fallback zu lokalen Partnern (--fallback-local Flag)

CLI-BEFEHLE (bach partner)
--------------------------
  list          Zeigt alle registrierten Partner und ihren Status
  status        Zusammenfassung aktiver Partner und Delegation-Zonen
  info <name>   Details zu einem spezifischen Partner
  active        Nur aktive Partner auflisten
  delegate      Überträgt einen Task an Partner (Token-aware)
                --to=NAME         Spezifischer Partner
                --zone=N          Zone erzwingen (1-4)
                --fallback-local  Bei Offline auf lokale AI (Ollama) ausweichen

GEMINI WORKFLOW
---------------
Gemini ist der primäre Partner für Deep-Analysis und Long-Form Content:

1. ZUWEISUNG:
   `bach partner delegate "Task Text" --to=gemini`
   Alternativ: Delegation via MessageBox (data/messages/message_box.md)

2. START:
   Über `partners/gemini/start_gemini.bat`
   Antigravity lädt automatisch Kontext aus .gemini/GEMINI.md

3. BEARBEITUNG:
   Partner arbeitet autark in `partners/gemini/workspace/`

4. ABSCHLUSS:
   Bericht in `partners/gemini/outbox/` ablegen
   Task als erledigt markieren: `bach task done ID`

TOKEN-ZONEN & STRATEGIE
-----------------------
Basierend auf monitor_tokens.budget_percent aus bach.db:

- Zone 1 (0-30%):   Alle Partner verfügbar (Claude, Gemini, etc.)
- Zone 2 (30-60%):  Kostengünstige Partner bevorzugt (Gemini, Ollama)
- Zone 3 (60-80%):  Nur lokale AI (Ollama)
- Zone 4 (80-100%): Nur Human (Intervention erforderlich)

ARCHITEKTUR-HINWEIS
-------------------
Delegation ist DB-basiert (seit JSON_001 Migration):
- Partner in partner_recognition Tabelle
- Zonen-Regeln in delegation_rules Tabelle
- Token-Budget in monitor_tokens Tabelle
- Delegation-Messages in data/messages/message_box.md

SIEHE AUCH
----------
docs/docs/docs/help/partner.txt                 Partner-Konzept (Zonen, Routing)
wiki/gemini.txt             Gemini-Details
wiki/antigravity.txt        Antigravity-Editor
hub/partner.py                   Partner Handler Implementation
data/bach.db                     Partner-Registry (partner_recognition, delegation_rules)
